{"ast":null,"code":"import _regeneratorRuntime from\"/home/dci/Desktop/movies-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/dci/Desktop/movies-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/dci/Desktop/movies-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/dci/Desktop/movies-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/dci/Desktop/movies-test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{API_URL,API_KEY}from\"../config\";export var useHomeFetch=function useHomeFetch(){var _useState=useState({movies:[]}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var fetchMovie=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(ApiUrl){var page,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setError(false);setLoading(true);page=ApiUrl.search('page');_context.prev=3;_context.next=6;return fetch(ApiUrl);case 6:_context.next=8;return _context.sent.json();case 8:result=_context.sent;console.log(\"results\",result);setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{movies:page!==-1?[].concat(_toConsumableArray(prev.movies),_toConsumableArray(result.results)):_toConsumableArray(result.results),heroImage:prev.heroImage||result.results[0],currentPage:result.page,totalPages:result.total_pages});});_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](3);setError(true);console.log(_context.t0);case 17:setLoading(false);case 18:case\"end\":return _context.stop();}}},_callee,null,[[3,13]]);}));return function fetchMovie(_x){return _ref.apply(this,arguments);};}();useEffect(function(){fetchMovie(\"\".concat(API_URL,\"movie/popular?api_key=\").concat(API_KEY));},[]);return[{state:state,loading:loading,error:error},fetchMovie];};","map":{"version":3,"sources":["/home/dci/Desktop/movies-test/src/store/useHomeFetch.js"],"names":["useState","useEffect","API_URL","API_KEY","useHomeFetch","movies","state","setState","loading","setLoading","error","setError","fetchMovie","ApiUrl","page","search","fetch","json","result","console","log","prev","results","heroImage","currentPage","totalPages","total_pages"],"mappings":"wuBAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,OACEC,OADF,CAEEC,OAFF,KAGO,WAHP,CAKA,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,eACNJ,QAAQ,CAAC,CAAEK,MAAM,CAAE,EAAV,CAAD,CADF,wCACzBC,KADyB,eAClBC,QADkB,8BAEFP,QAAQ,CAAC,KAAD,CAFN,yCAEzBQ,OAFyB,eAEhBC,UAFgB,8BAGNT,QAAQ,CAAC,KAAD,CAHF,yCAGzBU,KAHyB,eAGlBC,QAHkB,eAKhC,GAAMC,CAAAA,UAAU,0FAAG,iBAAOC,MAAP,kIACjBF,QAAQ,CAAC,KAAD,CAAR,CACAF,UAAU,CAAC,IAAD,CAAV,CACMK,IAHW,CAGJD,MAAM,CAACE,MAAP,CAAc,MAAd,CAHI,uCAMaC,CAAAA,KAAK,CAACH,MAAD,CANlB,6CAM4BI,IAN5B,UAMTC,MANS,eAOfC,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAuBF,MAAvB,EACAX,QAAQ,CAAC,SAACc,IAAD,wCACJA,IADI,MAEPhB,MAAM,CAAGS,IAAI,GAAK,CAAC,CAAV,8BAAkBO,IAAI,CAAChB,MAAvB,qBAAkCa,MAAM,CAACI,OAAzC,sBAAwDJ,MAAM,CAACI,OAA/D,CAFF,CAGPC,SAAS,CAAEF,IAAI,CAACE,SAAL,EAAkBL,MAAM,CAACI,OAAP,CAAe,CAAf,CAHtB,CAIPE,WAAW,CAAEN,MAAM,CAACJ,IAJb,CAKPW,UAAU,CAAEP,MAAM,CAACQ,WALZ,IAAD,CAAR,CARe,iFAgBff,QAAQ,CAAC,IAAD,CAAR,CACAQ,OAAO,CAACC,GAAR,cAjBe,QAmBjBX,UAAU,CAAC,KAAD,CAAV,CAnBiB,qEAAH,kBAAVG,CAAAA,UAAU,4CAAhB,CAsBAX,SAAS,CAAC,UAAM,CACdW,UAAU,WAAIV,OAAJ,kCAAoCC,OAApC,EAAV,CACD,CAFQ,CAEN,EAFM,CAAT,CAIA,MAAO,CAAC,CAAEG,KAAK,CAALA,KAAF,CAASE,OAAO,CAAPA,OAAT,CAAkBE,KAAK,CAALA,KAAlB,CAAD,CAA4BE,UAA5B,CAAP,CACD,CAhCM","sourcesContent":["import { useState, useEffect } from \"react\";\nimport {\n  API_URL,\n  API_KEY,\n} from \"../config\";\n\nexport const useHomeFetch = () => {\n  const [state, setState] = useState({ movies: [] });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(false);\n\n  const fetchMovie = async (ApiUrl) => {\n    setError(false);\n    setLoading(true);\n    const page = ApiUrl.search('page');\n\n    try {\n      const result = await (await fetch(ApiUrl)).json();\n      console.log(\"results\", result);\n      setState((prev) => ({\n        ...prev,\n        movies:  page !== -1 ? [...prev.movies, ...result.results] : [...result.results],\n        heroImage: prev.heroImage || result.results[0],\n        currentPage: result.page,\n        totalPages: result.total_pages,\n      }));\n    } catch (err) {\n      setError(true);\n      console.log(err);\n    }\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    fetchMovie(`${API_URL}movie/popular?api_key=${API_KEY}`);\n  }, []);\n\n  return [{ state, loading, error }, fetchMovie];\n};\n"]},"metadata":{},"sourceType":"module"}